#### 懒加载

- 是专门针对单实例说的；

- 单实例bean：容器在启动的时候创建对象；
- 懒加载（通过使用@Lazy注解）：容器启动不创建对象。第一次使用（获取）bean时会创建对象，并初始化。

#### @Conditional

如果该注解放在类上，则如果满足当前条件，这个类里配置的所有bean才会生效。

#### @Import

快速导入组件，id默认是组件的全类名。

#### 给容器中注册组件

1. 包扫描 + 组件标注注解（@Controller/@Service/@Repository/@Component）；
2. @Bean导入第三方包里面的组件；
3. @Import 快速给容器中导入一个组件
   - @Import(要导入到容器中的组件)：容器中就会自动注册这个组件，id默认是全类名；
   - @ImportSelector：返回需要导入的组件的全类名数组；
   - @ImportBeanDefinitionRegistrar：手动注册bean到容器中。
4. 使用spring提供的FactoryBean（工厂bean）

​       在spring与其他框架整合的时候，用FactoryBean比较多。



#### bean的生命周期

bean的创建、初始化、销毁的过程。

我们可以自定义初始化、销毁的过程。

##### 第一种方式

通过@Bean指定init-method和destory-method方法。

##### 第二种方式

通过让Bean实现InitializingBean（定义初始化逻辑），实现DisposableBean（定义销毁逻辑）。

##### 第三种方式

通过使用JSR250规范里边定义的两个注解。

@PostConstruct

这个注解的作用就是会在bean都装配完成、对象创建、属性赋值完成以后，执行一些初始化方法。

@PreDestory

在容器销毁bean之前，通知我们进行清理工作。

##### 第四种方式

BeanPostProcessor，是个接口，bean的后置处理器。包含两个方法：

postProcessBeforeInitialization：在初始化之前工作

postProcessAfterInitialization：在初始化之后工作

#### BeanPostProcessor 

BeanPostProcessor在spring底层的使用，有bean赋值、@Autowired、生命周期注解功能、@Async等。

#### @PropertySource

使用@PropertySource读取外部配置文件中的k/v保存到运行的环境变量中；加载外部的配置文件以后可使用${}取出配置文件的值，比如：

persion.properties：

```
info.nickname="lisi"
```

然后：

```java
public class Person {

  @Value("${info.nickname}")
	private String nickName;
}
```

#### @Autowired

MyAppConfig：

```java
@Configuration
public class MyAppConfig{
	@Bean("bookDao2")  // 一处
	public BookDao bookDao2() {
		return new BookDao();
	}
}

@Controller
public class BookController {
  @Autowired
  private BookService;
}

@Service
public class BookService {
	@Autowired // 二处
  private BookDao bookDao;
}

@Repository
public class BookDao {
	
}
```

这样在IOC容器里会有同一个类型BookDao的两个bean。



1. 默认会先按照类型去容器中查找对应的组件 =》 applicationContext.getBean(BookDao.class);

2. 如果找到了多个相同类型的组件，再将属性的名称做为组件的id去容器中查找 =》applicationContext.getBean("bookDao");

3. 如果确实就是想使用 bookDao2，这时可以使用 =》@Qualifier("bookDao2")，指定需要装配的组件id，而不是使用类的属性名。

4. 自动装配默认一定要将属性赋值好，否则会报错。比如这里如果将一处和二处的注解去掉，则启动容器的时候就会报错。解决办法：可以将二处的@Autowired注解改为：

   ```java
   @Autowired(required=false)
   ```

   即可。如果没有，则就为null，不会报错了。

5. 也就是将@Autowired和@Qualifier结合使用，来为容器中注入指定的组件。







